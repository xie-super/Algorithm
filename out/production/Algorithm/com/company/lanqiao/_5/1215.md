## 小朋友排队

最优解：冒泡排序思想
- eg
5 2 4 3 1
2号小朋友前面有一个比其身高高的小朋友，其必然与其交换，后面5号小朋友比其身高矮，两者必定交换。
思想：枚举每位小朋友，前面有k1位小朋友身高比其高，后面有k2位小朋友身高比其矮，其需交换次数为k1+k2
方法：树状数组求前面高于其身高的小朋友，后面比其矮的小朋友。数组存储身高从0-H<sub>max</sub>的对应每个身高的人数，tr[i]为某一身高区间的人数

求解方法，如5 2 1 3 4这一队列，
首先5进队。  _ _ _ _ 5,
2进队后询问队列中其后面比其大的数，也就是原始队列中在其前面比其大的数，k1 = 1; 队列此时为_ 2 _ _5
1入队，后面比其大的数为2 5， k1 = 2...... 
****
- code
```java

package com.company.lanqiao._5;

import java.io.*;
import java.util.Arrays;

/**
 * Author:xie-super
 * Time:2022/3/18
 * Name:1215. 小朋友排队
 * 贪心、树状数组
 */
public class _1215 {
    static final int N = 1000010;
    static int[] tr = new int[N];
    static int[] h = new int[N];
    //存储每个小朋友需要交换的次数
    static int[] sum = new int[N];
    static int n;

    static int lowbit(int x){
        return x & -x;
    }
    static int query(int x){
        int res = 0;
        for(int i = x; i>0; i-=lowbit(i)){
            res += tr[i];
        }
        return res;
    }
    static void add(int x, int v){
        for(int i = x; i<N; i+=lowbit(i)){
            tr[i]+=v;
        }
    }
    public static void main(String[] args) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
        BufferedWriter writer = new BufferedWriter(new OutputStreamWriter(System.out));

        String[] sp;

        n = Integer.parseInt(reader.readLine());
        sp = reader.readLine().split(" ");
        for(int i = 1; i<=n; i++){
            h[i] =  Integer.parseInt(sp[i-1]);
            h[i]++;
        }

        //看前面有多少身高高于i的
        for(int i = 1; i<=n; i++){
            sum[i]=  query(N-1)-query(h[i]);
            add(h[i], 1);//此身高的人数+1
        }


        Arrays.fill(tr,0);
        //看后面有多少身高低于i的
        for(int i = n; i>=1; i--){
            sum[i]+=query(h[i]-1);
            add(h[i], 1);
        }

        long res = 0;
        for(int i = 1; i<=n; i++){
            res+= (long) (1 + sum[i]) *sum[i]/2;
        }
        writer.write(res+"");
        writer.flush();
        writer.close();
        reader.close();


    }
}

```


